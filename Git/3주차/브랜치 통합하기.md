# 브랜치 통합하기

브랜치 통합에는 `merge` 를 사용하는 방법과 `rebase`를 사용하는 방법의 2가지 종류가 있다. 
어느 쪽을 사용하느냐에 따라 통합 후의 브랜치의 이력이 크게 달라진다. 하나씩 어떤 의미인지 알아보자. 

<br>

## 1. merge란?

merge를 사용하면 여러 개의 브랜치를 하나로 모을 수 있다. 예를 들어, 아래 그림과 같이 `master`브랜치에서 뻗어 나오는 `bugfix`라는 브랜치를 봐보자.

![image](https://user-images.githubusercontent.com/45676906/97183616-566d0d80-17e1-11eb-9812-eff83431e9ae.png)

현재 상황은 master 브랜치에서 뻗어 나온 이후로 `bugfix`에서 커밋을 2번 해서 위의 그림과 같이 진행이 된 상황이다. 

<br>

이 `bugfix` 브랜치를 `master`브랜치로 병합할 때, `master` 브랜치의 상태가 bugfix 브랜치를 만들었을 때의 상태와 같다면 매우 쉽게 `merge`할 수 있다.
`bugfix` 브랜치는 `master` 브랜치의 이력을 모두 포함하고 있기 때문에, `master` 브랜치는 단순히 이동하기만 해도 `bugfix` 브랜치와 합쳐질 수 있다. 
이 같은 병합을 `fast-forward(빨리 감기)병합`이라고 한다.

![image](https://user-images.githubusercontent.com/45676906/97184252-0f334c80-17e2-11eb-9b32-5cf3bdfcac30.png)

그러면 `GitKraken`과 `CLI`를 이용해서 실습을 해보자. 

<br>

## 실습

<img width="1792" alt="스크린샷 2020-10-26 오후 11 29 07" src="https://user-images.githubusercontent.com/45676906/97185129-0bec9080-17e3-11eb-9b9e-0d27a8d3aa4c.png">

현재의 상황은 위의 그림과 같고 여기서 `feature_jg`라는 브랜치를 만들어서 브랜치에서 커밋을 해보자. 

<br>

<img width="700" alt="스크린샷 2020-10-26 오후 11 32 11" src="https://user-images.githubusercontent.com/45676906/97185508-7998bc80-17e3-11eb-953b-9334b1bbc9f4.png">

위와 그림은 `master` 브랜치에서 `feature_jg` 브랜치를 만들면서 이동하고 `fast.md`라는 파일을 만들어 간단히 내용을 적어준 후에 commit까지 한 상태이다. 

<img width="1792" alt="스크린샷 2020-10-26 오후 11 33 29" src="https://user-images.githubusercontent.com/45676906/97185749-c9778380-17e3-11eb-9c59-f438c47a3b03.png">

그리고 나서 `GitKraken`을 확인해보면 브랜치를 만들었음에도 불구하고 `master` 브랜치에서 가지처럼 뻗어나가는 것이 아니라 일자의 모양을 볼 수 있다.(`일자 모양이라고 해서 브랜치가 없다고 생각하면 안된다.`)
일자인 이유는 master 브랜치에 상태변화가 없기 때문이다. 만약 master 브랜치에도 커밋을 하고 feature_jg에도 커밋을 한다면 평소에 보던 대로 가지치는 모양이 나올 것이다. 
현재 상황이 맨 위에 첫 번째 그림의 상황과 같다. 한마디로 여기서 `merge`를 하면 `fast-forward-merge`가 되는 것이다.

<br>

그리고 다시 `master` 브랜치를 돌아와서 `feature_jg` 브랜치와 `merge`를 해보자. 머지하는 명령어는 아래와 같다.

```
git merge 브랜치이름
ex) git merge feature_jg 
(현재는 feature_jg를 master에 merge하는 상황이기 때문에 master 브랜치로 와서 feature_jg와 병합을 해야 한다.)
```

<img width="698" alt="스크린샷 2020-10-26 오후 11 37 37" src="https://user-images.githubusercontent.com/45676906/97186162-4d317000-17e4-11eb-89ea-5aea7d075b17.png">

그러면 위와 같이 `merge`가 성공한 것을 볼 수 있고, `Fast-forward`라는 것이 뜨는 것도 확인할 수 있다. 한마디로 master 브랜치를 feaeture_jg 브랜치가 있는 곳까지 `빨리감기`를
한 상황이다.

<br>

## 브랜치 병합: project level

master 브랜치에는 A라는 파일을 만들고, feature_jg 브랜치에서는 B라는 파일을 만들어서 두 개의 브랜치를 merge하면 어떻게 될까?
실습을 해보면서 결과를 확인해보자. 

![스크린샷 2020-10-26 오후 11 49 37](https://user-images.githubusercontent.com/45676906/97187670-05abe380-17e6-11eb-8d2d-9f971f13b3d1.png)

위와 같이 `feature_jg`에서 파일을 하나 만들고 `master` 브랜치로 넘어가자.

<img width="709" alt="스크린샷 2020-10-26 오후 11 52 09" src="https://user-images.githubusercontent.com/45676906/97187948-51f72380-17e6-11eb-86a4-db4a92bd678e.png">

그리고 master 브랜치에서도 새로운 파일을 하나 만들었다. 

<img width="1792" alt="스크린샷 2020-10-26 오후 11 53 29" src="https://user-images.githubusercontent.com/45676906/97188130-85d24900-17e6-11eb-9c50-d048b45460b0.png">

그리고 이번에 `GitKraken`을 확인해보면 브랜치의 모양이 일자가 아니라 가지모양이 만들어진 것도 확인할 수 있다. 이제 master브랜치에서 두 개의 브랜치를 merge 해보자. 

```
git merge feature_jg
```

<img width="710" alt="스크린샷 2020-10-26 오후 11 56 05" src="https://user-images.githubusercontent.com/45676906/97188491-e6fa1c80-17e6-11eb-9352-9eff83d20c3d.png">

그러면 위와 같이 `commit message`를 입력할 수 있는 화면이 나올 것이다. 나는 기본으로 제공해주는 `커밋 메세지`로 merge를 하였다. 

<img width="709" alt="스크린샷 2020-10-26 오후 11 57 47" src="https://user-images.githubusercontent.com/45676906/97188719-2cb6e500-17e7-11eb-8988-726d37d4529c.png">

그러면 성공적으로 머지가 된 것을 확인할 수 있고, 각 브랜치에서 만들었던 파일로 문제없이 잘 합쳐진 것도 확인할 수 있다.

<br>

## 충돌 해결, Conflict resolve

두 개의 브랜치에서 동시에 같은 파일의 같은 곳을 수정하고, 그걸 병합할 때 `충돌`이 발생한다. 충돌이 발생했을 때 해결하는 것을 `Conflic resolve`라고 한다.
충돌이 발생했을 때, `CLI`에서 하는 법과 `GitKraken`을 이용해서 `resolve` 해보자. 

<img width="707" alt="스크린샷 2020-10-27 오전 12 35 17" src="https://user-images.githubusercontent.com/45676906/97193394-4c9cd780-17ec-11eb-86d2-a5fe9fb8fdad.png">

먼저 강제로 충돌을 만들어보자. master 브랜치에서 원하는 파일을 원하는 대로 수정을 해보자! 

<br>

그리고 feature_jg 브랜치로 가서 해당 파일을 아래와 같이 같은 라인을 다른 것으로 수정해보자.

<img width="708" alt="스크린샷 2020-10-27 오전 12 38 54" src="https://user-images.githubusercontent.com/45676906/97193840-cd5bd380-17ec-11eb-84b0-71139c9d757c.png">

위와 같이 첫 번째 줄을 `Gangnam!!`에서 `Git Study`로 바꿨다. 그리고 다시 master 브랜치로 넘어가서 merge를 시도해보자.

![스크린샷 2020-10-27 오전 12 42 28](https://user-images.githubusercontent.com/45676906/97194314-5b37be80-17ed-11eb-98cf-f7599296054a.png)

그러면 위와 같이 충돌이 발생하는 것을 볼 수 있다.

<br>

### 1. CLI로 충돌 해결하기

<img width="710" alt="스크린샷 2020-10-27 오전 12 44 44" src="https://user-images.githubusercontent.com/45676906/97194661-c2ee0980-17ed-11eb-9330-5a9ca53bcaf8.png">

충돌이 발생한 파일을 들어가보면 위와 같이 충돌이 일어난 부분을 표시해주는 것을 볼 수 있다.

- 충돌이 발생한 부분의 시작 : <<<<<HEAD
- 충돌 난 부분의 끝 : >>>>>feature_jg
- 중간 경계선 표시 : =========

양 쪽의 브랜치에서 같은 파일의 같은 행을 수정했기 때문에 Git은 어떤 수정 사항을 선택할 것인지 사용자에게 맡기는 것이다. 
이런 경우 충돌 난 두 브랜치 중 하나의 내용을 선택하거나, 두 수정 내역을 합치는 등 수동으로 충돌을 해결해야 한다. 
(`Tip : vi 명령모드에서 x : 문자 하나 삭제, dd : 한줄삭제`)

<br>

### 2. GitKraken 에서 충돌 해결 

